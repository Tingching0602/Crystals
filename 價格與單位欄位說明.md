# 價格與單位欄位更新說明

## 📋 更新內容

### 1. 資料結構變更

**舊格式：**
```json
{
  "title": "藍磷灰石球",
  "price": "790元"
}
```

**新格式：**
```json
{
  "title": "藍磷灰石球",
  "price": 790,
  "unit": "個"
}
```

### 2. 欄位說明

- **price**: 改為純數字（Number 類型），不包含「元」或其他符號
- **unit**: 新增單位欄位（String 類型），可選值：
  - `條` - 適用於手串、項鍊
  - `個` - 適用於水晶球、原礦
  - `對` - 適用於耳環
  - `組` - 適用於套組商品
  - `件` - 適用於其他商品

## 🛠️ 後台管理功能

### 新增/編輯商品

1. **價格欄位**
   - 輸入框改為數字類型
   - 前綴顯示 "NT$"
   - 只需輸入數字，例如：`1490`
   - ❌ 不要輸入：`1490元` 或 `NT$ 1490`
   - ✅ 正確輸入：`1490`

2. **單位欄位**
   - 下拉選單選擇
   - 可選：條、個、對、組、件
   - 根據商品類型自動預設：
     - 手串/項鍊 → 條
     - 水晶球 → 個
     - 耳環 → 對

### 商品列表顯示

商品表格的「價格」欄位會顯示：
```
NT$ 790 / 個
NT$ 1490 / 條
NT$ 1800 / 對
```

## 🎨 前台顯示

### 商品詳細頁面

```
邀請價: NT$ 790 / 個
```

### 購物車 & 結帳頁面

價格顯示會自動處理新舊格式：
- 新格式（數字）：直接使用
- 舊格式（字串）：自動解析提取數字

## 📝 已更新的檔案

### 模型檔案
- ✅ `src/model/balls.ts` - 已更新為新格式

### 其他模型檔案需要更新
以下檔案仍使用舊格式，需要手動更新或使用後台重新編輯：
- `src/model/crystals.ts`
- `src/model/simpleBracelets.ts`
- `src/model/tutles.ts`
- `src/model/ores.ts`
- `src/model/necklace.ts`
- `src/model/earrings.ts`

### 元件檔案
- ✅ `src/components/admin.vue` - 後台管理
- ✅ `src/components/crystal.vue` - 前台展示（新增 formatPrice 函數）
- ✅ `src/components/checkout.vue` - 購物車價格處理

### JSON 檔案
- ✅ `public/data/balls.json` - 已轉換為新格式
- ⚠️ 其他 JSON 檔案：執行轉換腳本後會更新

## 🔄 轉換舊資料

### 方法 1：使用轉換腳本

```bash
node scripts/convertToJson.js
```

這會將所有 TypeScript 模型檔案重新轉換為 JSON。

### 方法 2：使用後台批次更新

1. 進入後台管理
2. 選擇商品類型
3. 逐個編輯商品
4. 確保填寫：
   - 價格（純數字）
   - 單位（下拉選擇）
5. 儲存
6. 點擊「匯出 JSON」

### 方法 3：手動編輯 TypeScript 檔案

將所有商品的 price 從字串改為數字，並新增 unit 欄位：

```typescript
// 舊格式
{
  price: "1490元"
}

// 新格式
{
  price: 1490,
  unit: "條"
}
```

## ⚠️ 注意事項

1. **向後兼容**：系統仍支援舊格式的價格字串，會自動解析
2. **資料驗證**：後台儲存時會確保 price 為數字
3. **預設值**：
   - 新增商品時 price 預設為 0
   - unit 根據商品類型自動設定預設值
4. **顯示格式**：前台統一顯示為 `NT$ 數字 / 單位`

## 🧪 測試檢查清單

- [ ] 後台新增商品：價格輸入數字，選擇單位
- [ ] 後台編輯商品：確認價格和單位正確顯示
- [ ] 後台商品列表：價格顯示為 "NT$ XX / 單位"
- [ ] 前台商品詳情：價格顯示正確
- [ ] 購物車：價格計算正確
- [ ] 結帳頁面：總金額計算正確
- [ ] 匯出 JSON：包含正確的 price 數字和 unit 欄位

## 📚 範例

### 完整商品資料範例

```json
{
  "imgUrl": "https://i.imgur.com/onWIfqd.jpeg",
  "title": "藍磷灰石球",
  "note": "圓圓的臉圓圓的耳朵看起來就超療癒的❤️",
  "description": "商品描述...",
  "size": "43.6mm",
  "price": 790,
  "unit": "個",
  "priceType": "Price2"
}
```

### 不同類型商品的單位建議

| 商品類型 | 建議單位 |
|---------|---------|
| 設計款手串 | 條 |
| 素手串 | 條 |
| 雕刻件 | 個 |
| 水晶球 | 個 |
| 原礦 | 個 |
| 項鍊 | 條 |
| 耳環 | 對 |
